#!/bin/bash

# This script is used to start the training process of the model with all the
# steps.

# Define common arguments
type_options=("RGB" "BW")
preprocessing_options=("random" "black" "white")
extension_options=("png" "jpg")
model_options=("resnet18" "resnet50")
epochs_options=(10)

# Function to execute a command and handle errors
execute_command() {
	"$@"
	local exit_code=$?
	if [[ ${exit_code} -ne 0 ]]; then
		echo "Error executing command: $@"
		exit "${exit_code}"
	fi
}

# Loop through type and preprocessing options
for type in "${type_options[@]}"; do
	for preprocessing in "${preprocessing_options[@]}"; do
		for extension in "${extension_options[@]}"; do
			# Execute commands with the current type and preprocessing options
			execute_command python -m pre_processing.apk_to_image -t "${type}" -p "${preprocessing}" -ex "${extension}"
			execute_command python -m pre_processing.create_train_test
			for model in "${model_options[@]}"; do
				for epochs in "${epochs_options[@]}"; do
					execute_command python -m model_training.train_test_model -t "${type}" -p "${preprocessing}" -ex "${extension}" -e "${epochs}" -mn "${model}"
					execute_command python -m visualization.saliency -t "${type}" -p "${preprocessing}" -ex "${extension}" -e "${epochs}" -mn "${model}"
				done
			done
		done
	done
done
